# ìƒìš© í´ë¼ìš°ë“œ í™˜ê²½ì— ë°°í¬í•˜ê¸°
## 1. ë°°í¬ë¥¼ ìœ„í•œ AWS Cloud í™˜ê²½ êµ¬ì„±í•˜ê¸°
### AWS Cloud ì‹¤ìŠµ í™˜ê²½ êµ¬ì„±ë„
<img src="https://github.com/hyewon218/Building-CI-CD-pipelines-with-Jenkins/assets/126750615/6307cd50-e621-4303-be06-8b07511ab845" width="60%"/><br>
- Jenkinsì—ì„œ ë¹Œë“œ í›„ Tomcat ì„œë²„ë‚˜, Docker ì„œë²„ì— ë°°í¬ë¥¼ ì§„í–‰

<img src="https://github.com/hyewon218/Building-CI-CD-pipelines-with-Jenkins/assets/126750615/28d5b963-274d-4a07-9390-55b8c10b1852" width="60%"/><br>
- Jenkinsì—ì„œ ë¹Œë“œí•œ ê²°ê³¼ë¬¼ì„ Ansible ì— ì „ë‹¬í•˜ì—¬ Tomcat ì„œë²„, Docker ì„œë²„, sonarQube ì„œë²„ì— ë°°í¬ë¥¼ ì§„í–‰
- AWS EC2 êµ¬ì„±
    - Jenkins server: **8080** port
    - Docker server: 22 port
    - Tomcat server: **8080** port
    - Ansible server: 22 port
    - SOnarqube server: **9000** port

<br>

## 2. ì´ë¯¸ì§€ë¥¼ ì´ìš©í•˜ì—¬ AWS EC2 ìƒì„±í•˜ê¸°
<img src="https://github.com/hyewon218/Building-CI-CD-pipelines-with-Jenkins/assets/126750615/20c05031-8634-4ee0-8a9d-6b29ae784be9" width="60%"/><br>
<img src="https://github.com/hyewon218/Building-CI-CD-pipelines-with-Jenkins/assets/126750615/6dbbe9f2-aa3a-4597-a720-ce550cb55cd9" width="60%"/><br>
<img src="https://github.com/hyewon218/Building-CI-CD-pipelines-with-Jenkins/assets/126750615/fbccf35b-b34c-4bc4-9b45-f97182f493f3" width="40%"/><br>
<img src="https://github.com/hyewon218/Building-CI-CD-pipelines-with-Jenkins/assets/126750615/6cd8d97e-206d-4192-9dad-edeac90f1557" width="60%"/><br>
<img src="https://github.com/hyewon218/Building-CI-CD-pipelines-with-Jenkins/assets/126750615/ba9b3354-d193-4a56-9cec-badd256d4af0" width="60%"/><br>
- ì´ë¯¸ì§€ë¥¼ public ìƒíƒœë¡œ ë§Œë“¤ê²Œë˜ë©´ ê³µìœ í•  ìˆ˜ ìˆë‹¤.
- ìƒì„±ëœ ì´ë¯¸ì§€ë¥¼ í†µí•´ ê¸°ë³¸ ì‹œìŠ¤í…œ(java11, ...)ì´ ì„¤ì¹˜ëœ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì‰½ê²Œ ë§Œë“¤ ìˆ˜ ìˆë‹¤.

<br>

### ì´ë¯¸ì§€ë¥¼ í†µí•´ ì¸ìŠ¤í„´ìŠ¤ ìƒì„±
<img src="https://github.com/hyewon218/Building-CI-CD-pipelines-with-Jenkins/assets/126750615/b66d4e7c-0166-461e-a863-acd05f7c076d" width="60%"/><br>
- ì´ë¯¸ì§€ì— í•´ë‹¹í•˜ëŠ” ì¸ìŠ¤í„´ìŠ¤ì˜ í‚¤ í˜ì–´ë¥¼ ì„ íƒ
- ì´ë¯¸ì§€ì— í•´ë‹¹í•˜ëŠ” ì¸ìŠ¤í„´ìŠ¤ì˜ ë³´ì•ˆ ê·¸ë£¹ì„ ì„ íƒ
- Tomcat ì„œë²„, Docker ì„œë²„, SonarQube ì„œë²„, Ansible ì„œë²„ë¥¼ ìœ„í•´ 4ê°œì˜ ì¸ìŠ¤í„´ìŠ¤ ìƒì„±

<br>

<img src="https://github.com/hyewon218/Building-CI-CD-pipelines-with-Jenkins/assets/126750615/3e1ef779-2692-4a80-9826-b5e4ecb63642" width="60%"/><br>
ë‹¤ ê°™ì€ VPC(ê°€ìƒ ë„¤íŠ¸ì›Œí¬) ID

- ì´ë ‡ê²Œ ë§Œë“  5ê°œì˜ ì¸ìŠ¤í„´ìŠ¤ëŠ” ê°™ì€ ë„¤íŠ¸ì›Œí¬ì— ë¬¶ì—¬ìˆê¸° ë•Œë¬¸ì— ë™ì¼í•œ VPC IDë¥¼ ê°–ëŠ”ë‹¤.
- VPC(Virtual Private Cloud)ëŠ” ê¸°ì¡´ì˜ ê°€ìƒ ì‚¬ì„¤ ë„¤íŠ¸ì›Œí¬ë§ì„ êµ¬ì„±í•  ë•Œ VPN ì´ë¼ëŠ” ìš©ì–´ë¥¼ ì‚¬ìš©í•˜ëŠ”ë° AWS ì—ì„œëŠ” ì‚¬ì„¤ ë„¤íŠ¸ì›Œí¬ë§ì„ í´ë¼ìš°ë“œ í˜•íƒœë¡œ ì‚¬ìš©í•˜ê³  ìˆê¸° ë•Œë¬¸ì— VPC ë¼ê³ í•œë‹¤.
- VPC ëŠ” ê°€ìƒ ë„¤íŠ¸ì›Œí¬ì´ê¸° ë•Œë¬¸ì—, ê°€ìƒ ë„¤íŠ¸ì›Œí¬ì— ë¬¶ì—¬ìˆëŠ” PC ë“¤ê°„ì˜ í†µì‹ ì„ í•  ë•Œ ì•„ë¬´ëŸ° ì œì•½ì´ ì—†ë‹¤.
- ë”°ë¼ì„œ ì´ì œëŠ” ê° PC í†µì‹  ê°„ì— private IP ë¥¼ í†µí•´ì„œ í†µì‹ ì´ ê°€ëŠ¥í•˜ë‹¤.

<br>

### ì¸ìŠ¤í„´ìŠ¤ ê°„ í†µì‹ ì„ ìœ„í•œ ì¸ë°”ìš´ë“œ ê·œì¹™ í¸ì§‘
<img src="https://github.com/hyewon218/Building-CI-CD-pipelines-with-Jenkins/assets/126750615/4172bd6d-b3df-4d72-acb0-a0ca50c66fd8" width="60%"/><br>
- ì•ì—ì„œ ì„¤ì •í•œ ë³´ì•ˆê·¸ë£¹ ì„ íƒ
- ê°™ì€ VPCì— ìˆëŠ” ë³´ì•ˆê·¸ë£¹ ìƒì—ì„œëŠ” í†µì‹ ì´ ê°€ëŠ¥í•œ ìƒíƒœê°€ ëœë‹¤.

<br>

### ì¸ìŠ¤í„´ìŠ¤ ê°„ í†µì‹  í™•ì¸
jenkinsì—ì„œ dockerë¡œ ì ‘ì†í•´ë³´ê¸°<br>
<img src="https://github.com/hyewon218/Building-CI-CD-pipelines-with-Jenkins/assets/126750615/016765f9-e410-43fe-a5c0-6354276e126c" width="60%"/><br>
- ì •ìƒì ìœ¼ë¡œ ping í…ŒìŠ¤íŠ¸ë¥¼ ì„±ê³µ

ë°˜ëŒ€ë¡œ dockerì—ì„œ jenkinsë¡œ ì ‘ì†<br>
<img src="https://github.com/hyewon218/Building-CI-CD-pipelines-with-Jenkins/assets/126750615/b28cc07f-b5cb-4c95-879e-1192996a6a3f" width="60%"/><br>

<br>

## 3. AWS EC2ì— Jenkins ì„œë²„ ì„¤ì¹˜í•˜ê¸°
### Amazon Linux ì— í™•ì¥ íŒ¨í‚¤ì§€ ì„¤ì¹˜
í™•ì¥ íŒ¨í‚¤ì§€ë¥¼ ì„¤ì¹˜í•˜ëŠ” ëª©ì ì€ ì‚¬ìš© ì¤‘ì¸ Linux ì— ì¶”ê°€ì ì¸ Dependency íŒ¨í‚¤ì§€ë¥¼ í•œêº¼ë²ˆì— ì„¤ì¹˜í•  ìˆ˜ ìˆë‹¤.
```
sudo amazon-linux-extras install epel -y
```

<br>

### Maven ì„¤ì¹˜
(EC2ì—ì„œ ì‹¤í–‰ Maven ë²„ì „ì€ ë³€ê²½ë  ìˆ˜ ìˆìœ¼ë‹ˆ ì•„ë˜ ì‚¬ì´íŠ¸ì—ì„œ ë²„ì „ í™•ì¸ í•„ìš”)
- https://maven.apache.org/download.cgi
```
sudo amazon-linux-extra install epel -y
cd /opt
ls -ltr
sudo wget https://mirror.navercorp.com/apache/maven/maven-3/3.9.5/binaries/apache-maven-3.9.5-bin.tar.gz
sudo tar -xvzf apache-maven-3.9.5-bin.tar.gz
sudo mv apache-maven-3.9.5 maven 
cd maven/
```
- `epel` : extra package for enterprise linux
- cd /opt : maven ì„¤ì¹˜ ë””ë ‰í„°ë¦¬
- -xvf : x â†’ extract(ì••ì¶•í•´ì œ), v(ì••ì¶•ë˜ëŠ” ê³¼ì •ì„ ë³´ê² ë‹¤.),z(gzí¬í•¨), f(íŒŒì¼ëª…ì„ ì§€ì •í•˜ê² ë‹¤.)

<br>

<img src="https://github.com/hyewon218/Building-CI-CD-pipelines-with-Jenkins/assets/126750615/259d3db9-5441-4fbd-bb9b-7f0676909daf" width="60%"/><br>
<img src="https://github.com/hyewon218/Building-CI-CD-pipelines-with-Jenkins/assets/126750615/0762c8cc-6e07-4e69-8dba-d56ee444e562" width="60%"/><br>
<img src="https://github.com/hyewon218/Building-CI-CD-pipelines-with-Jenkins/assets/126750615/ca54acaf-6c16-427b-b4a2-442f85960d2d" width="60%"/><br>
<img src="https://github.com/hyewon218/Building-CI-CD-pipelines-with-Jenkins/assets/126750615/bc28cb52-6e6b-4dad-ad51-a1448f37b022" width="60%"/><br>

<br>

### í™˜ê²½ì„¤ì •
```
vi ~/.bash_profile
source ~/.bash_profile
```
- ~ : í™ˆ ë””ë ‰í† ë¦¬
- .bash_profile ìˆ˜ì •
  ```
  M2_HOME=/opt/maven
  PATH=$PATH:$M2_HOME:$M2_HOME/bin
  ```
  <img src="https://github.com/hyewon218/Building-CI-CD-pipelines-with-Jenkins/assets/126750615/4976554c-b471-43d0-a4e1-55a7b658bbe4" width="60%"/><br>
- source ì»¤ë§¨ë“œë¥¼ í†µí•´ ë³€ê²½ì‚¬í•­ ì ìš©<br>
  <img src="https://github.com/hyewon218/Building-CI-CD-pipelines-with-Jenkins/assets/126750615/3d51b864-a68a-4d70-a760-8f5c0f45f635" width="60%"/><br>

<br>

### Git ì„¤ì¹˜
```
sudo yum install -y git
```

### Jenkins ì„¤ì¹˜ (EC2ì—ì„œ ì‹¤í–‰)
```
(sudo amazon-linux-extras install epel -y)
sudo wget -O /etc/yum.repos.d/jenkins.repo https://pkg.jenkins.io/redhat-stable/jenkins.repo
sudo rpm --import https://pkg.jenkins.io/redhat-stable/jenkins.io.key
```
- https://pkg.jenkins.io/redhat-stable/ <br>
  <img src="https://github.com/hyewon218/Building-CI-CD-pipelines-with-Jenkins/assets/126750615/a4e32de9-4359-42b4-b1bd-6e50026fb475" width="60%"/><br>

#### ğŸ“Java Jenkins í˜¸í™˜ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ Java ì¬ì„¤ì¹˜ ë° ë²„ì „ ë³€ê²½
```
sudo amazon-linux-extras install java-openjdk11 
sudo /usr/sbin/alternatives --config java
```
- ì´ë¯¸ì§€ì— JDKê°€ ì„¤ì¹˜ ë˜ì–´ìˆëŠ” ìƒíƒœ â†’ ë²„ì „ì„ ë°”ê¿”ì£¼ì–´ì•¼ í•œë‹¤.
  <img src="https://github.com/hyewon218/Building-CI-CD-pipelines-with-Jenkins/assets/126750615/a4e32de9-4359-42b4-b1bd-6e50026fb475" width="60%"/><br>

<br>

#### ğŸ“Jenkins ì„¤ì¹˜
<img src="https://github.com/hyewon218/Building-CI-CD-pipelines-with-Jenkins/assets/126750615/a4e32de9-4359-42b4-b1bd-6e50026fb475" width="60%"/><br>
```
sudo yum install jenkins
```

<br>

#### ğŸ“Jenkins ì‹¤í–‰
```
sudo systemctl status jenkins
sudo systemctl start jenkins
```
<img src="https://github.com/hyewon218/Building-CI-CD-pipelines-with-Jenkins/assets/126750615/170be445-2912-4827-92a0-3a4133b2ef85" width="60%"/><br>
<img src="https://github.com/hyewon218/Building-CI-CD-pipelines-with-Jenkins/assets/126750615/bb51e48d-2819-4c49-813c-ad9d053020a6" width="60%"/><br>
<img src="https://github.com/hyewon218/Building-CI-CD-pipelines-with-Jenkins/assets/126750615/9b7fbb83-c0e0-4a74-8a09-6da7d724fd47" width="60%"/><br>
- jenkins í¬íŠ¸ : 8080 - ì–´ë””ì—ì„œë„(í˜¸ìŠ¤íŠ¸pc) ì ‘ì†í•  ìˆ˜ ìˆë„ë¡

<img src="https://github.com/hyewon218/Building-CI-CD-pipelines-with-Jenkins/assets/126750615/bb51e48d-2819-4c49-813c-ad9d053020a6" width="60%"/><br>

<br>

#### ğŸ“Jenkins ì´ˆê¸° ì•”í˜¸ í™•ì¸
```
sudo cat /var/lib/jenkins/secrets/initialAdminPassword
```

<br>

## 4. AWS EC2ì— Docker ì„œë²„ ì„¤ì¹˜í•˜ê¸°
### AWSì˜ EC2ì— Docker ì„¤ì¹˜
```
sudo amazon-linux-extras install epel -y
sudo yum install â€“y docker
```

#### Docker Test
```
docker â€“version
```
```
sudo systemctl enable docker
sudo systemctl start docker
sudo docker version
docker version
```

#### ê³„ì •í™•ì¸
```
whoami
```

<br>

### Docker ì‹¤í–‰
```
sudo usermod -aG docker ec2-user (ì¸ìŠ¤í„´ìŠ¤ ì¬ ì ‘ì†)
sudo service docker start
docker run hello-world
```
- usermod : ê·¸ë£¹ ì¶”ê°€

<br>

## 5. AWS EC2ì— Tomcat ì„œë²„ ì„¤ì¹˜í•˜ê¸°
- https://tomcat.apache.org/download-90.cgi (ë‹¤ìš´ë¡œë“œ ê°€ëŠ¥í•œ ìµœì‹  ë²„ì „ í™•ì¸ í›„ ì§„í–‰)
  - apache-tomcat-9.0.83.tar.gz
```
sudo amazon-linux-extras install epel -y

cd /opt
sudo wget https://mirror.navercorp.com/apache/tomcat/tomcat-9/v9.0.83/bin/apache-tomcat-9.0.83.tar.gz
sudo tar -xvzf apache-tomcat-9.0.83.tar.gz

sudo chmod +x ./bin/startup.sh
sudo chmod +x ./bin/shutdown.sh
```
- -xvzf : ì••ì¶•í’€ê¸°
- chmod : ë¹ˆ ë””ë ‰í† ë¦¬ ì¤‘ì—ì„œ `startup` `shutdown` ì‹¤í–‰ ê¶Œí•œ í¬í•¨

<img src="https://github.com/hyewon218/Building-CI-CD-pipelines-with-Jenkins/assets/126750615/2c84fc84-8ca9-4caa-bcdb-3315c5ef11cb" width="60%"/><br>

<br>

### Tomcat ì‹¤í–‰
```
sudo /opt/apache-tomcat-9.0.70/bin/startup.sh
```
<img src="https://github.com/hyewon218/Building-CI-CD-pipelines-with-Jenkins/assets/126750615/855eee6c-055c-4d98-8fb2-3dd2fd98f9fc" width="60%"/><br>
<img src="https://github.com/hyewon218/Building-CI-CD-pipelines-with-Jenkins/assets/126750615/c705352d-3629-4a3c-a3d0-1823689df914" width="60%"/><br>

<br>

### Tomcat ì œí•œ ì œê±°, ê³„ì • ê¶Œí•œ ì¶”ê°€
```
sudo vi ./webapps/manager/META-INF/context.xml # ì œí•œ ì œê±°
sudo vi ./webapps/host-manager/META-INF/context.xml # ì œí•œ ì œê±°
sudo vi ./conf/tomcat-users.xml # ê³„ì • ê¶Œí•œ ì¶”ê°€
sudo ./bin/shutdown.sh
sudo ./bin/startup.sh
```
`./webapps/manager/META-INF/context.xml`
- ê¸°ì¡´ ì ‘ì† ê²½ë¡œë¥¼ 127.x.x.xìœ¼ë¡œ ì œí•œëœ ë¶€ë¶„ì„ ì£¼ì„ì²˜ë¦¬í•¨ìœ¼ë¡œì¨ ëª¨ë“  ì ‘ì†ì„ í—ˆìš©<br>
  <img src="https://github.com/hyewon218/Building-CI-CD-pipelines-with-Jenkins/assets/126750615/f91fccf0-97dc-4020-bf7b-021295149b02" width="60%"/><br>

`./webapps/host-manager/META-INF/context.xml`
- ê¸°ì¡´ ì ‘ì† ê²½ë¡œë¥¼ 127.x.x.xìœ¼ë¡œ ì œí•œëœ ë¶€ë¶„ì„ ì£¼ì„ì²˜ë¦¬í•¨ìœ¼ë¡œì¨ ëª¨ë“  ì ‘ì†ì„ í—ˆìš©<br>
  <img src="https://github.com/hyewon218/Building-CI-CD-pipelines-with-Jenkins/assets/126750615/818891dd-0f77-4842-a43f-60cab5ef03e1" width="60%"/><br>

`./conf/tomcat-users.xml` <br>
 <img src="https://github.com/hyewon218/Building-CI-CD-pipelines-with-Jenkins/assets/126750615/818891dd-0f77-4842-a43f-60cab5ef03e1" width="60%"/><br>

<img src="https://github.com/hyewon218/Building-CI-CD-pipelines-with-Jenkins/assets/126750615/3c987fa0-71f0-4424-b61f-49f82d6ae74b" width="60%"/><br>

<img src="https://github.com/hyewon218/Building-CI-CD-pipelines-with-Jenkins/assets/126750615/dc9401f8-ab43-452c-86bc-e70392be5163" width="60%"/><br>


<br>

## 6. AWS EC2ì— Ansible ì„œë²„ ì„¤ì¹˜í•˜ê¸°
```
sudo amazon-linux-extras install epel -y
sudo yum install â€“y ansible
```
### hosts íŒŒì¼ ìˆ˜ì •
```
ssh-keygen -t rsa
```

### ssh ì ‘ì†ì„ ìœ„í•œ í‚¤ ìƒì„±
```
ssh-keygen -t rsa
```
<img src="https://github.com/hyewon218/Building-CI-CD-pipelines-with-Jenkins/assets/126750615/57b437b3-389c-4608-93dd-e03fa24ba6f3" width="60%"/><br>
- id_rsa : private key ê°’
- id_rsa.pub : public ket ê°’

<br>

### ìƒì„±ëœ public í‚¤(id_rsa.pub)ë¥¼ docker, tomcat ì„œë²„ì— ë³µì‚¬
Ansible ì„œë²„ì˜ public í‚¤ ë³µì‚¬
```
cd ~
cat .ssh/id_rsa.pub
```

Ansible ì„œë²„ì˜ public í‚¤ë¥¼ Tomcat ì„œë²„ì˜`.ssh/authorized_keys` ì— ë³µì‚¬
Ansible ì„œë²„ì˜ public í‚¤ë¥¼ Docker ì„œë²„ì˜`.ssh/authorized_keys`ì— ë³µì‚¬

<br>

### ì—°ê²° í…ŒìŠ¤íŠ¸
```
ssh ec2-user@[ec2_ip_address]
```
- ansibleì—ì„œ docker ì—°ê²°<br>
  <img src="https://github.com/hyewon218/Building-CI-CD-pipelines-with-Jenkins/assets/126750615/1a625fde-61d2-4618-bcf8-41b9734d57f8" width="60%"/><br>
- ansibleì—ì„œ tomcat ì—°ê²°<br>
  <img src="https://github.com/hyewon218/Building-CI-CD-pipelines-with-Jenkins/assets/126750615/20c63af3-6c59-4c13-86b2-a65f61e6997c" width="60%"/><br>

<br>

### ping í…ŒìŠ¤íŠ¸
```
ansible docker -m ping
ansible tomcat -m ping
ansible localhost -m ping
ansible all -m ping
```
<img src="https://github.com/hyewon218/Building-CI-CD-pipelines-with-Jenkins/assets/126750615/f8b58276-0519-49e1-9398-5db16a3ecf78" width="60%"/><br>

<br>

## 7. AWS EC2ì— SonarQube ì„¤ì¹˜í•˜ê¸°
> SonarQube ëŠ” ì• ì˜ˆì œì—ì„œ ì‚¬ìš©í•œ ec2 t2.micro íƒ€ì…ì¸ ê²½ìš°ì— ë¦¬ì†ŒìŠ¤ ë¶€ì¡±ìœ¼ë¡œ ì •ìƒì ì¸ ì„œë¹„ìŠ¤ê°€ ì–´ë ¤ìš¸ ìˆ˜ ìˆê¸° ë•Œë¬¸ì— 
> ìµœì†Œ t2.small íƒ€ì…ìœ¼ë¡œ ì§„í–‰í•´ì•¼í•œë‹¤.

### EC2 ì¸ìŠ¤í„´ìŠ¤ íƒ€ì… ë³€ê²½
<img src="https://github.com/hyewon218/Building-CI-CD-pipelines-with-Jenkins/assets/126750615/963b2f6f-fc12-4d80-8811-70a69e1dfa51" width="40%"/><br>
<img src="https://github.com/hyewon218/Building-CI-CD-pipelines-with-Jenkins/assets/126750615/37446b56-cbf8-4453-b0c4-c03bcb1b0a76" width="40%"/><br>

<br>

### SonarQube ì„¤ì¹˜
```
sudo amazon-linux-extras install epel -y
sudo mkdir /opt/sonarqube
cd /opt/sonarqube
sudo wget https://binaries.sonarsource.com/Distribution/sonarqube/sonarqube-7.6.zip
sudo unzip sonarqube-7.6.zip 
sudo chown -R ec2-user:ec2-user /opt/sonarqube/
```
<img src="https://github.com/hyewon218/Building-CI-CD-pipelines-with-Jenkins/assets/126750615/2410c359-4946-4d31-9513-991bfaf3cdf6" width="60%"/><br>
<img src="https://github.com/hyewon218/Building-CI-CD-pipelines-with-Jenkins/assets/126750615/e76b2181-c00f-4932-b6fc-bc1988a07df4" width="60%"/><br>
- root ê¶Œí•œì—ì„œ ec2-user ê¶Œí•œìœ¼ë¡œ

<br>

### SonarQube ì„¤ì • íŒŒì¼
`/opt/sonarqube/sonarqube-7.6/conf/sonar.properties`
<img src="https://github.com/hyewon218/Building-CI-CD-pipelines-with-Jenkins/assets/126750615/2838d33b-4b8a-4c56-80ce-424666abc6d3" width="60%"/><br>
- default port ë²ˆí˜¸ê°€ 9000

<br>

### SonarQube ì‹¤í–‰
```
cd sonarqube-7.6/
./bin/[ì‚¬ìš©í•˜ëŠ” OS]/sonar.sh start # 
./bin/linux-x86-64/sonar.sh start
```
<img src="https://github.com/hyewon218/Building-CI-CD-pipelines-with-Jenkins/assets/126750615/48eaf01f-e248-43a9-a36d-21761e5897fc" width="60%"/><br>

<br>

### SonarQube í…ŒìŠ¤íŠ¸
<img src="https://github.com/hyewon218/Building-CI-CD-pipelines-with-Jenkins/assets/126750615/8b1c7f7a-efaa-49e8-afbe-7f59d6e7d075" width="60%"/><br>
<img src="https://github.com/hyewon218/Building-CI-CD-pipelines-with-Jenkins/assets/126750615/7a4e5290-a76d-4534-8672-0e92d3e9cdf5" width="60%"/><br>
- 9000ë²ˆ í¬íŠ¸ open<br>
  `http://[public ip address]:9000/`

<br>

## 8. Jenkins ë¥¼ ì´ìš©í•˜ì—¬ Tomcat ì„œë²„ì— ë°°í¬í•˜ê¸°
### Maven, Deploy to Container í”ŒëŸ¬ê·¸ì¸ ì„¤ì¹˜
<img src="https://github.com/hyewon218/Building-CI-CD-pipelines-with-Jenkins/assets/126750615/44b43e53-31ed-4c4b-a106-88bed169cff2" width="60%"/><br>

<br>

### Maven ì„¤ì •
<img src="https://github.com/hyewon218/Building-CI-CD-pipelines-with-Jenkins/assets/126750615/fd8389b0-cd83-49fb-ba98-b17f15e46c55" width="60%"/><br>
-  /opt/maven: Jenkins ì„œë²„ì— ì„¤ì¹˜í•œ Maven ì˜ Home ë””ë ‰í† ë¦¬
   <img src="https://github.com/hyewon218/Building-CI-CD-pipelines-with-Jenkins/assets/126750615/71141268-bc43-4ecb-be1f-c3f26c7e26e4" width="60%"/><br>
   <img src="https://github.com/hyewon218/Building-CI-CD-pipelines-with-Jenkins/assets/126750615/cf32a190-91d7-469b-b9c5-dd3f182a93ef" width="60%"/><br>

<br>

## Project ìƒì„± ë° ì„¤ì •
ì•„ì´í…œ ìƒì„±<br>
<img src="https://github.com/hyewon218/Building-CI-CD-pipelines-with-Jenkins/assets/126750615/7f579d60-cfa3-4b50-8211-e4eaf128be70" width="60%"/><br>
<img src="https://github.com/hyewon218/Building-CI-CD-pipelines-with-Jenkins/assets/126750615/79d430fd-b959-4d74-ac78-f2f5c28876fa" width="60%"/><br>
<img src="https://github.com/hyewon218/Building-CI-CD-pipelines-with-Jenkins/assets/126750615/bffb15d2-c648-4dfa-a0f5-30b72100300d" width="60%"/><br>
<img src="https://github.com/hyewon218/Building-CI-CD-pipelines-with-Jenkins/assets/126750615/2ce24297-09a5-41f5-bd99-d09b768bf61e" width="60%"/><br>
- githubì—ì„œ ê°€ì§€ê³  ì˜¨ ì†ŒìŠ¤ì½”ë“œë¥¼ waríŒŒì¼ë¡œ íŒ¨í‚¤ì§• í•œ í›„ tomcat ì„œë²„ì— ë°°í¬<br>
  <img src="https://github.com/hyewon218/Building-CI-CD-pipelines-with-Jenkins/assets/126750615/ba7dde29-8103-46e2-a141-e21f196141ad" width="60%"/><br>
  - Credential ìƒì„±

<br>

### ë¹Œë“œ
### ê²°ê³¼
`Jenkins ë¹Œë“œëœ ê²°ê³¼ë¬¼`<br>
<img src="https://github.com/hyewon218/Building-CI-CD-pipelines-with-Jenkins/assets/126750615/07a4a73d-9767-4b7d-acff-38096f45f2a9" width="60%"/><br>
<img src="https://github.com/hyewon218/Building-CI-CD-pipelines-with-Jenkins/assets/126750615/b440e503-66d1-48ff-96dc-654b1f44ead9" width="60%"/><br>
- targer : gitì—ì„œ ê°€ì ¸ì˜¨ ì½”ë“œ

`Tomcatì— ë°°í¬ëœ ê²°ê³¼ë¬¼`<br>
<img src="https://github.com/hyewon218/Building-CI-CD-pipelines-with-Jenkins/assets/126750615/e544a226-fd0f-4b11-80c9-563997b7b73f" width="60%"/><br>

<br>

## 9. Jenkins ë¥¼ ì´ìš©í•˜ì—¬ Docker ì„œë²„ì— ë°°í¬í•˜ê¸°
### Jenkins ì„œë²„ì—ì„œ Docker ì„œë²„ë¡œ ssh ì ‘ì†ì„ ìœ„í•œ í‚¤ ë°°í¬
- Jenkins ì„œë²„ì—ì„œ`ssh-keygen`ëª…ë ¹ì–´ë¡œ ìƒì„±ëœ public í‚¤ ë³µì‚¬<br>
  <img src="https://github.com/hyewon218/Building-CI-CD-pipelines-with-Jenkins/assets/126750615/a6c275d2-f7f6-4dfb-8ae2-9966652dd96d" width="60%"/><br>
- Docker ì„œë²„ì— Jenkins ì„œë²„ public í‚¤ ë¶™ì—¬ë„£ê¸°<br>
  <img src="https://github.com/hyewon218/Building-CI-CD-pipelines-with-Jenkins/assets/126750615/36494f10-8dd8-4f72-b18b-2a5f016f3e41" width="60%"/><br>
- Jenkins ì„œë²„ì—ì„œ Docker ì„œë²„ë¡œ ì ‘ì†<br>
  <img src="https://github.com/hyewon218/Building-CI-CD-pipelines-with-Jenkins/assets/126750615/2161c0eb-8b2b-4875-a61c-feb9a26b667d" width="60%"/><br>

<br>

### publish over ssh í”ŒëŸ¬ê·¸ì¸ ì„¤ì¹˜
<img src="https://github.com/hyewon218/Building-CI-CD-pipelines-with-Jenkins/assets/126750615/6d2bfaa1-13d4-4b61-a846-b08cbfc0d1fe" width="60%"/><br>

<br>

### publish over ssh ì„¤ì •
- Jenkins ì„œë²„ì—ì„œ`ssh-keygen`ëª…ë ¹ì–´ë¥¼ í†µí•´ ìƒì„±í•œ public í‚¤ë¥¼ Docker ì„œë²„ì— ë³µì‚¬í•˜ì˜€ê³  Jenkins ì„œë²„ì—ì„œ Docker ì„œë²„ë¡œ ì ‘ì†í•  ë•ŒëŠ” private í‚¤(`id_rsa`)ë¥¼ ê°€ì§€ê³  ì ‘ì†ì„ ì‹œë„í•˜ì—¬ ë§¤ì¹­ì„ í†µí•´ ì ‘ì† ì—¬ë¶€ë¥¼ ê²°ì •í•œë‹¤.
- Jenkins ì˜ ssh ì„¤ì • ì •ë³´ì— private í‚¤ë¥¼ ë“±ë¡í•´ì•¼ì§€ Docker ì„œë²„ë¡œ ì ‘ì†ì´ ê°€ëŠ¥í•˜ë‹¤.<br>
  <img src="https://github.com/hyewon218/Building-CI-CD-pipelines-with-Jenkins/assets/126750615/dac18d78-6b83-46d4-a19e-ffab2da904ce" width="60%"/><br>

<br>

### Project ìƒì„± ë° ì„¤ì •
<img src="https://github.com/hyewon218/Building-CI-CD-pipelines-with-Jenkins/assets/126750615/88d7dba6-126e-44cc-8396-bb58a3034566" width="60%"/><br>

<br>

### Docker ì„œë²„ì— Dockerfile ìƒì„±
```
FROM tomcat:9.0

COPY ./hello-world.war /usr/local/tomcat/webapps
```
<img src="https://github.com/hyewon218/Building-CI-CD-pipelines-with-Jenkins/assets/126750615/bec9f29f-d38d-4869-b668-492d66f1ace9" width="60%"/><br>

### Docker ëª…ë ¹ì–´
```
docker build --tag=cicd-project -f Dockerfile .
docker run -d -p 8080:8080 --name mytomcat cicd-project:latest
```
<img src="https://github.com/hyewon218/Building-CI-CD-pipelines-with-Jenkins/assets/126750615/600d2f48-c27c-47d3-8744-9a7a2b53f46d" width="60%"/><br>
<img src="https://github.com/hyewon218/Building-CI-CD-pipelines-with-Jenkins/assets/126750615/2257fc25-e48a-46ca-bfbf-acda71a5c471" width="60%"/><br>
- ì´ë¯¸ì§€ê°€ ë¹Œë“œê°€ ì˜ ëìœ¼ë©´ Dockerfile ì‹¤í–‰
- ì´ë¯¸ì§€ ì´ë¦„ì€ cicd-project
- ë§Œë“¤ì–´ì§„ ì´ë¯¸ì§€ë¥¼ ê°€ì§€ê³  ì»¨í…Œì´ë„ˆ ìƒì„±

<br>

### ê²°ê³¼
<img src="https://github.com/hyewon218/Building-CI-CD-pipelines-with-Jenkins/assets/126750615/94593d65-0a67-4f67-8cd4-a402adc4205c" width="60%"/><br>
<img src="https://github.com/hyewon218/Building-CI-CD-pipelines-with-Jenkins/assets/126750615/1b50410d-967d-4c08-aa3b-1731cb94c57a" width="60%"/><br>

<br>

## 10. Jenkins ë¥¼ ì´ìš©í•˜ì—¬ Ansible ì„œë²„ì— ë°°í¬í•˜ê¸°
### Jenkins ì—ì„œ ssh ì ‘ì†ì„ ìœ„í•œ Ansible ì„œë²„ ë“±ë¡
private keyë¥¼ ì´ìš©í•´ì„œ ì ‘ì† ì‹œë„<br>
<img src="https://github.com/hyewon218/Building-CI-CD-pipelines-with-Jenkins/assets/126750615/90c373b1-df2d-4fd8-bf5b-56dfa1abe38c" width="60%"/><br>
<img src="https://github.com/hyewon218/Building-CI-CD-pipelines-with-Jenkins/assets/126750615/cbe5ac0a-1d5b-4b3d-a28e-013122395263" width="60%"/><br>
<img src="https://github.com/hyewon218/Building-CI-CD-pipelines-with-Jenkins/assets/126750615/45a5987f-60fa-4039-a6a2-62d7c2ac5b27" width="60%"/><br>

<br>

### Inventory íŒŒì¼ & Playbook íŒŒì¼ ìƒì„±
`hosts`
```
[docker]
172.31.11.22
```
`create-cicd-devops-container.yml`
```
- hosts: all
  #   become: true

  tasks:
    - name: stop current running container
      command: docker stop my_cicd_project
      ignore_errors: yes

    - name: remove stopped cotainer
      command: docker rm my_cicd_project
      ignore_errors: yes

    - name: create a container using cicd-project-ansible image
      command: docker run --privileged -d --name my_cicd_project -p 8080:8080 won1110218/cicd-project-final
```
- ì»¨í…Œì´ë„ˆê°€ ìƒì„±ë§Œ ë˜ë„ë¡ í•  ê²ƒì„

<br>

### Project ìƒì„± ë° ì„¤ì •
<img src="https://github.com/hyewon218/Building-CI-CD-pipelines-with-Jenkins/assets/126750615/0cd1aa99-b2e8-4316-9bf0-e5bd8aba382c" width="60%"/><br>
<img src="https://github.com/hyewon218/Building-CI-CD-pipelines-with-Jenkins/assets/126750615/56bbe1e7-053d-41cf-bb50-ac1900b956ba" width="60%"/><br>
<br>
<img src="https://github.com/hyewon218/Building-CI-CD-pipelines-with-Jenkins/assets/126750615/04214e73-77dc-4370-931e-2c2f2a71169d" width="60%"/><br>
```
docker build --tag=won1110218/cicd-project-final -f Dockerfile . ;
```
<img src="https://github.com/hyewon218/Building-CI-CD-pipelines-with-Jenkins/assets/126750615/1906326d-a234-4527-a162-434afc8f2df9" width="60%"/><br>
```
ansible-playbook -i hosts create-cicd-devops-container.yml;
```

<br>

### ë¹Œë“œ
<img src="https://github.com/hyewon218/Building-CI-CD-pipelines-with-Jenkins/assets/126750615/bba36ca9-4003-4687-9e68-a8e67525308b" width="60%"/><br>
<img src="https://github.com/hyewon218/Building-CI-CD-pipelines-with-Jenkins/assets/126750615/be5d22a7-bdc2-43fc-acea-0b85eee022ec" width="60%"/><br>

<br>

### ê²°ê³¼
<img src="https://github.com/hyewon218/Building-CI-CD-pipelines-with-Jenkins/assets/126750615/576e72a5-10bb-49ee-bb25-3a4ba4e7b211" width="60%"/><br>